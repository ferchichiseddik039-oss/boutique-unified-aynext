{"ast":null,"code":"import _objectSpread from\"C:/Users/houda/OneDrive/Bureau/boutique-vetements/boutique-unified/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Link,useLocation}from'react-router-dom';import{FaSearch,FaFilter,FaSort,FaHeart,FaShoppingCart,FaPalette}from'react-icons/fa';import{toast}from'react-toastify';import{useCart}from'../contexts/CartContext';import{useAuth}from'../contexts/AuthContext';import{formatBrand,debugObjects}from'../utils/formatUtils';import DebugWrapper from'../components/DebugWrapper';import SimpleHoodieDesigner from'../components/SimpleHoodieDesigner';import api from'../config/axios';import'../styles/Products.css';// Composant carte produit\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ProductCard=_ref=>{var _product$images,_product$images$,_product$images2,_product$images2$;let{product,onAddToCart,onCustomize}=_ref;// D√©bogage des donn√©es du produit\nuseEffect(()=>{debugObjects(product,'ProductCard - product');if(product!==null&&product!==void 0&&product.marque){debugObjects(product.marque,'ProductCard - product.marque');}},[product]);const handleCardClick=()=>{// Navigation vers la page de d√©tail du produit\nwindow.location.href=\"/product/\".concat(product._id);};return/*#__PURE__*/_jsxs(\"div\",{className:\"product-card\",onClick:handleCardClick,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-image\",children:[/*#__PURE__*/_jsx(\"img\",{src:(product===null||product===void 0?void 0:(_product$images=product.images)===null||_product$images===void 0?void 0:(_product$images$=_product$images[0])===null||_product$images$===void 0?void 0:_product$images$.url)||'/placeholder-product.jpg',alt:(product===null||product===void 0?void 0:(_product$images2=product.images)===null||_product$images2===void 0?void 0:(_product$images2$=_product$images2[0])===null||_product$images2$===void 0?void 0:_product$images2$.alt)||(product===null||product===void 0?void 0:product.nom)||'Produit',onError:e=>{e.target.src='/placeholder-product.jpg';}}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-btn favorite\",title:\"Ajouter aux favoris\",onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(FaHeart,{})}),(product===null||product===void 0?void 0:product.estPersonnalise)&&/*#__PURE__*/_jsx(\"button\",{className:\"action-btn customize\",onClick:e=>{e.stopPropagation();onCustomize(product);},title:\"Personnaliser\",children:/*#__PURE__*/_jsx(FaPalette,{})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"product-name\",children:(product===null||product===void 0?void 0:product.nom)||'Produit'}),/*#__PURE__*/_jsx(\"p\",{className:\"product-brand\",children:formatBrand(product===null||product===void 0?void 0:product.marque)}),/*#__PURE__*/_jsx(\"div\",{className:\"product-price\",children:product!==null&&product!==void 0&&product.prixPromo?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"original-price\",children:[(product===null||product===void 0?void 0:product.prix)||0,\" TND\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"promo-price\",children:[(product===null||product===void 0?void 0:product.prixPromo)||0,\" TND\"]})]}):/*#__PURE__*/_jsxs(\"span\",{className:\"price\",children:[(product===null||product===void 0?void 0:product.prix)||0,\" TND\"]})})]})]});};const Products=()=>{const[products,setProducts]=useState([]);const[loading,setLoading]=useState(true);const[categories,setCategories]=useState([]);const[brands,setBrands]=useState([]);const[filters,setFilters]=useState({category:'',genre:'',brand:'',minPrice:'',maxPrice:'',size:'',color:''});const[sortBy,setSortBy]=useState('name');const[searchTerm,setSearchTerm]=useState('');const[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(1);const[showFilters,setShowFilters]=useState(false);const[timeoutError,setTimeoutError]=useState(false);const[showCustomizer,setShowCustomizer]=useState(false);const[selectedProduct,setSelectedProduct]=useState(null);const{addToCart}=useCart();const{user,isAuthenticated}=useAuth();const location=useLocation();// Log de d√©bogage pour v√©rifier l'√©tat de connexion\nuseEffect(()=>{console.log('üîç √âtat de connexion dans Products:',{user:!!user,isAuthenticated,userId:user===null||user===void 0?void 0:user._id});},[user,isAuthenticated]);// G√©rer les param√®tres URL pour les filtres\nuseEffect(()=>{const searchParams=new URLSearchParams(location.search);const genreParam=searchParams.get('genre');const categoryParam=searchParams.get('categorie');if(genreParam){setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{genre:genreParam,category:''// R√©initialiser la cat√©gorie si on filtre par genre\n}));}else if(categoryParam){setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{category:categoryParam,genre:''// R√©initialiser le genre si on filtre par cat√©gorie\n}));}},[location.search]);useEffect(()=>{// Charger les produits en priorit√©\nfetchProducts();// Charger les cat√©gories et marques seulement si pas encore charg√©es\nif(categories.length===0){fetchCategories();}if(brands.length===0){fetchBrands();}},[filters,sortBy,searchTerm,currentPage]);const fetchProducts=async()=>{try{setLoading(true);const params={page:currentPage,limit:12,tri:sortBy};// Mapper les filtres vers les noms attendus par le backend\nif(filters.category)params.categorie=filters.category;if(filters.genre)params.genre=filters.genre;if(filters.brand)params.marque=filters.brand;if(filters.minPrice)params.prixMin=filters.minPrice;if(filters.maxPrice)params.prixMax=filters.maxPrice;if(filters.size)params.taille=filters.size;if(filters.color)params.couleur=filters.color;if(searchTerm)params.recherche=searchTerm;// Ajouter un timeout pour √©viter les attentes trop longues\nconst controller=new AbortController();const timeoutId=setTimeout(()=>controller.abort(),2000);// 2 secondes max\nconst response=await api.get('/products',{params,signal:controller.signal,timeout:2000});clearTimeout(timeoutId);const data=response.data;const produits=data.products||[];debugObjects(produits,'Products - fetchProducts');// Filtrer les produits pour ne garder que ceux qui sont disponibles (en stock)\nconst produitsDisponibles=produits.filter(product=>{// V√©rifier si le produit a des tailles avec du stock\nif(product.tailles&&Array.isArray(product.tailles)){return product.tailles.some(taille=>taille.stock>0);}// Si pas de tailles d√©finies, consid√©rer comme disponible\nreturn true;});console.log('Produits re√ßus:',produits.length);console.log('Produits disponibles apr√®s filtrage:',produitsDisponibles.length);setProducts(produitsDisponibles);setTotalPages(data.totalPages||1);}catch(error){if(error.name==='AbortError'){console.log('Timeout: Le serveur met trop de temps √† r√©pondre');setTimeoutError(true);setProducts([]);setTotalPages(1);}else{console.log('Aucun produit trouv√© ou base de donn√©es vide');setTimeoutError(false);setProducts([]);setTotalPages(1);}}finally{setLoading(false);}};const fetchCategories=async()=>{try{// Utiliser des cat√©gories statiques pour simplifier\nconst staticCategories=[{_id:'1',nom:'Hoodies',code:'hoodies'},{_id:'2',nom:'T-Shirts',code:'t-shirts'},{_id:'3',nom:'Sweats',code:'sweats'},{_id:'4',nom:'Pantalons',code:'pantalons'},{_id:'5',nom:'Accessoires',code:'accessoires'}];setCategories(staticCategories);}catch(error){console.log('Erreur chargement cat√©gories');setCategories([]);}};const fetchBrands=async()=>{try{// Utiliser des marques statiques pour simplifier\nconst staticBrands=[{_id:'1',nom:'Premium',code:'premium'},{_id:'2',nom:'Basique',code:'basique'},{_id:'3',nom:'Comfort',code:'comfort'},{_id:'4',nom:'Style',code:'style'},{_id:'5',nom:'Sport',code:'sport'}];setBrands(staticBrands);}catch(error){console.log('Erreur chargement marques');setBrands([]);}};const handleFilterChange=(key,value)=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:value}));setCurrentPage(1);};const handleSortChange=value=>{setSortBy(value);setCurrentPage(1);};const handleSearch=e=>{e.preventDefault();setCurrentPage(1);};const clearFilters=()=>{setFilters({category:'',brand:'',minPrice:'',maxPrice:'',size:'',color:''});setSearchTerm('');setCurrentPage(1);};const handleRetry=()=>{setTimeoutError(false);setLoading(true);fetchProducts();};const handleAddToCart=async(product,selectedSize,selectedColor)=>{console.log('handleAddToCart appel√© avec:',{product:product===null||product===void 0?void 0:product.nom,productId:product===null||product===void 0?void 0:product._id,selectedSize,selectedColor,user:!!user});if(!user){console.log('Utilisateur non connect√©');toast.error('Veuillez vous connecter pour ajouter au panier');return;}// Utiliser des valeurs par d√©faut si aucune taille/couleur s√©lectionn√©e\nconst size=selectedSize||'M';const color=selectedColor||'Noir';console.log('Tentative d\\'ajout au panier...');const result=await addToCart(product._id,1,size,color);console.log('R√©sultat de l\\'ajout au panier:',result);if(!result.success){// Le toast d'erreur est d√©j√† affich√© dans CartContext\nconsole.error('Erreur ajout au panier:',result.message);}};const handleCustomize=product=>{setSelectedProduct(product);setShowCustomizer(true);};const handleCloseCustomizer=()=>{setShowCustomizer(false);setSelectedProduct(null);};const handleCustomAddToCart=async(customProduct,selectedSize,selectedColor)=>{var _customProduct$person,_customProduct$person2;if(!user){toast.error('Veuillez vous connecter pour ajouter au panier');return;}// Pour les produits personnalis√©s, on ajoute les informations de personnalisation\nconst customData={productId:customProduct._id,personnalisation:customProduct.personnalisation,size:selectedSize||'M',color:selectedColor||((_customProduct$person=customProduct.personnalisation)===null||_customProduct$person===void 0?void 0:(_customProduct$person2=_customProduct$person.couleur)===null||_customProduct$person2===void 0?void 0:_customProduct$person2.nom)||'Noir'};console.log('Ajout produit personnalis√© au panier:',customData);// Ici, vous pourriez adapter la logique d'ajout au panier pour les produits personnalis√©s\nconst result=await addToCart(customProduct._id,1,customData.size,customData.color);if(result.success){toast.success('Produit personnalis√© ajout√© au panier !');handleCloseCustomizer();}else{console.error('Erreur ajout produit personnalis√©:',result.message);}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des produits...\"})]});}return/*#__PURE__*/_jsxs(DebugWrapper,{name:\"Products\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"products-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"products-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Nos Produits\"}),/*#__PURE__*/_jsx(\"p\",{children:\"D\\xE9couvrez notre collection de v\\xEAtements tendance\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"products-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filters-sidebar \".concat(showFilters?'show':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filters-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Filtres\"}),/*#__PURE__*/_jsx(\"button\",{className:\"clear-filters\",onClick:clearFilters,children:\"Effacer\"})]}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSearch,className:\"search-form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-input\",children:[/*#__PURE__*/_jsx(FaSearch,{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Rechercher un produit...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)})]})}),categories&&categories.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Cat\\xE9gorie\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.category,onChange:e=>handleFilterChange('category',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les cat\\xE9gories\"}),categories.map(cat=>{const key=typeof cat==='object'?cat._id||cat.code||cat.nom||'unknown':cat;const value=typeof cat==='object'?cat.nom||cat.code||cat._id||'':cat;const display=typeof cat==='object'?cat.nom||cat.code||cat._id||'':cat;return/*#__PURE__*/_jsx(\"option\",{value:value,children:display},key);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Genre\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.genre,onChange:e=>handleFilterChange('genre',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tous les genres\"}),/*#__PURE__*/_jsx(\"option\",{value:\"homme\",children:\"\\uD83D\\uDC68 Homme\"}),/*#__PURE__*/_jsx(\"option\",{value:\"femme\",children:\"\\uD83D\\uDC69 Femme\"}),/*#__PURE__*/_jsx(\"option\",{value:\"enfant\",children:\"\\uD83D\\uDC76 Enfant\"}),/*#__PURE__*/_jsx(\"option\",{value:\"sport\",children:\"\\uD83C\\uDFC3 Sport\"})]})]}),brands&&brands.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Marque\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.brand,onChange:e=>handleFilterChange('brand',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les marques\"}),brands.map(brand=>{const key=typeof brand==='object'?brand._id||brand.code||brand.nom||'unknown':brand;const value=typeof brand==='object'?brand.nom||brand.code||brand._id||'':brand;const display=typeof brand==='object'?brand.nom||brand.code||brand._id||'':brand;return/*#__PURE__*/_jsx(\"option\",{value:value,children:display},key);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Prix\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-inputs\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Min\",value:filters.minPrice,onChange:e=>handleFilterChange('minPrice',e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Max\",value:filters.maxPrice,onChange:e=>handleFilterChange('maxPrice',e.target.value)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Taille\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.size,onChange:e=>handleFilterChange('size',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les tailles\"}),/*#__PURE__*/_jsx(\"option\",{value:\"XS\",children:\"XS\"}),/*#__PURE__*/_jsx(\"option\",{value:\"S\",children:\"S\"}),/*#__PURE__*/_jsx(\"option\",{value:\"M\",children:\"M\"}),/*#__PURE__*/_jsx(\"option\",{value:\"L\",children:\"L\"}),/*#__PURE__*/_jsx(\"option\",{value:\"XL\",children:\"XL\"}),/*#__PURE__*/_jsx(\"option\",{value:\"XXL\",children:\"XXL\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Couleur\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.color,onChange:e=>handleFilterChange('color',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les couleurs\"}),/*#__PURE__*/_jsx(\"option\",{value:\"noir\",children:\"Noir\"}),/*#__PURE__*/_jsx(\"option\",{value:\"blanc\",children:\"Blanc\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rouge\",children:\"Rouge\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bleu\",children:\"Bleu\"}),/*#__PURE__*/_jsx(\"option\",{value:\"vert\",children:\"Vert\"}),/*#__PURE__*/_jsx(\"option\",{value:\"jaune\",children:\"Jaune\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rose\",children:\"Rose\"}),/*#__PURE__*/_jsx(\"option\",{value:\"gris\",children:\"Gris\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"products-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"products-toolbar\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"filters-toggle\",onClick:()=>setShowFilters(!showFilters),children:[/*#__PURE__*/_jsx(FaFilter,{}),\"Filtres\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sort-controls\",children:[/*#__PURE__*/_jsx(FaSort,{}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>handleSortChange(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"name\",children:\"Nom A-Z\"}),/*#__PURE__*/_jsx(\"option\",{value:\"-name\",children:\"Nom Z-A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"prix\",children:\"Prix croissant\"}),/*#__PURE__*/_jsx(\"option\",{value:\"-prix\",children:\"Prix d\\xE9croissant\"}),/*#__PURE__*/_jsx(\"option\",{value:\"createdAt\",children:\"Plus r\\xE9cents\"}),/*#__PURE__*/_jsx(\"option\",{value:\"-createdAt\",children:\"Plus anciens\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"results-info\",children:[(products===null||products===void 0?void 0:products.length)||0,\" produit(s) disponible(s)\",/*#__PURE__*/_jsx(\"small\",{style:{display:'block',color:'#666',fontSize:'0.9em'},children:\"Seuls les produits en stock sont affich\\xE9s\"})]})]}),!products||products.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-products\",children:timeoutError?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u23F1\\uFE0F D\\xE9lai d'attente d\\xE9pass\\xE9\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Le serveur met trop de temps \\xE0 r\\xE9pondre. Voulez-vous r\\xE9essayer ?\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRetry,className:\"retry-button\",children:\"\\uD83D\\uDD04 R\\xE9essayer\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Aucun produit disponible\"}),/*#__PURE__*/_jsx(\"p\",{children:searchTerm||Object.values(filters).some(f=>f)?\"Aucun produit en stock ne correspond √† vos crit√®res. Essayez de modifier vos filtres ou votre recherche.\":\"Aucun produit en stock pour le moment. La boutique est en cours de pr√©paration. Revenez bient√¥t !\"})]})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"products-grid\",children:products===null||products===void 0?void 0:products.map(product=>/*#__PURE__*/_jsx(ProductCard,{product:product,onAddToCart:handleAddToCart,onCustomize:handleCustomize},product._id))}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(prev=>Math.max(1,prev-1)),disabled:currentPage===1,children:\"Pr\\xE9c\\xE9dent\"}),Array.from({length:totalPages},(_,i)=>i+1).map(page=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(page),className:currentPage===page?'active':'',children:page},page)),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(prev=>Math.min(totalPages,prev+1)),disabled:currentPage===totalPages,children:\"Suivant\"})]})]})]})]})]}),showCustomizer&&selectedProduct&&/*#__PURE__*/_jsx(SimpleHoodieDesigner,{onClose:handleCloseCustomizer})]});};export default Products;","map":{"version":3,"names":["React","useState","useEffect","Link","useLocation","FaSearch","FaFilter","FaSort","FaHeart","FaShoppingCart","FaPalette","toast","useCart","useAuth","formatBrand","debugObjects","DebugWrapper","SimpleHoodieDesigner","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProductCard","_ref","_product$images","_product$images$","_product$images2","_product$images2$","product","onAddToCart","onCustomize","marque","handleCardClick","window","location","href","concat","_id","className","onClick","children","src","images","url","alt","nom","onError","e","target","title","stopPropagation","estPersonnalise","prixPromo","prix","Products","products","setProducts","loading","setLoading","categories","setCategories","brands","setBrands","filters","setFilters","category","genre","brand","minPrice","maxPrice","size","color","sortBy","setSortBy","searchTerm","setSearchTerm","currentPage","setCurrentPage","totalPages","setTotalPages","showFilters","setShowFilters","timeoutError","setTimeoutError","showCustomizer","setShowCustomizer","selectedProduct","setSelectedProduct","addToCart","user","isAuthenticated","console","log","userId","searchParams","URLSearchParams","search","genreParam","get","categoryParam","prev","_objectSpread","fetchProducts","length","fetchCategories","fetchBrands","params","page","limit","tri","categorie","prixMin","prixMax","taille","couleur","recherche","controller","AbortController","timeoutId","setTimeout","abort","response","signal","timeout","clearTimeout","data","produits","produitsDisponibles","filter","tailles","Array","isArray","some","stock","error","name","staticCategories","code","staticBrands","handleFilterChange","key","value","handleSortChange","handleSearch","preventDefault","clearFilters","handleRetry","handleAddToCart","selectedSize","selectedColor","productId","result","success","message","handleCustomize","handleCloseCustomizer","handleCustomAddToCart","customProduct","_customProduct$person","_customProduct$person2","customData","personnalisation","onSubmit","type","placeholder","onChange","map","cat","display","style","fontSize","Object","values","f","Math","max","disabled","from","_","i","min","onClose"],"sources":["C:/Users/houda/OneDrive/Bureau/boutique-vetements/boutique-unified/frontend/src/pages/Products.js"],"sourcesContent":["\nimport React, { useState, useEffect } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport { FaSearch, FaFilter, FaSort, FaHeart, FaShoppingCart, FaPalette } from 'react-icons/fa';\nimport { toast } from 'react-toastify';\nimport { useCart } from '../contexts/CartContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport { formatBrand, debugObjects } from '../utils/formatUtils';\nimport DebugWrapper from '../components/DebugWrapper';\nimport SimpleHoodieDesigner from '../components/SimpleHoodieDesigner';\nimport api from '../config/axios';\nimport '../styles/Products.css';\n\n// Composant carte produit\nconst ProductCard = ({ product, onAddToCart, onCustomize }) => {\n\n  // D√©bogage des donn√©es du produit\n  useEffect(() => {\n    debugObjects(product, 'ProductCard - product');\n    if (product?.marque) {\n      debugObjects(product.marque, 'ProductCard - product.marque');\n    }\n  }, [product]);\n\n  const handleCardClick = () => {\n    // Navigation vers la page de d√©tail du produit\n    window.location.href = `/product/${product._id}`;\n  };\n\n  return (\n    <div className=\"product-card\" onClick={handleCardClick}>\n      <div className=\"product-image\">\n        <img \n          src={product?.images?.[0]?.url || '/placeholder-product.jpg'} \n          alt={product?.images?.[0]?.alt || product?.nom || 'Produit'}\n          onError={(e) => {\n            e.target.src = '/placeholder-product.jpg';\n          }}\n        />\n        <div className=\"product-actions\">\n          <button \n            className=\"action-btn favorite\"\n            title=\"Ajouter aux favoris\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <FaHeart />\n          </button>\n          {product?.estPersonnalise && (\n            <button \n              className=\"action-btn customize\"\n              onClick={(e) => {\n                e.stopPropagation();\n                onCustomize(product);\n              }}\n              title=\"Personnaliser\"\n            >\n              <FaPalette />\n            </button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"product-info\">\n        <h3 className=\"product-name\">\n          {product?.nom || 'Produit'}\n        </h3>\n        \n        <p className=\"product-brand\">{formatBrand(product?.marque)}</p>\n        \n        <div className=\"product-price\">\n          {product?.prixPromo ? (\n            <>\n              <span className=\"original-price\">{product?.prix || 0} TND</span>\n              <span className=\"promo-price\">{product?.prixPromo || 0} TND</span>\n            </>\n          ) : (\n            <span className=\"price\">{product?.prix || 0} TND</span>\n          )}\n        </div>\n      </div>\n\n    </div>\n  );\n};\n\nconst Products = () => {\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [categories, setCategories] = useState([]);\n  const [brands, setBrands] = useState([]);\n  const [filters, setFilters] = useState({\n    category: '',\n    genre: '',\n    brand: '',\n    minPrice: '',\n    maxPrice: '',\n    size: '',\n    color: ''\n  });\n  const [sortBy, setSortBy] = useState('name');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [showFilters, setShowFilters] = useState(false);\n  const [timeoutError, setTimeoutError] = useState(false);\n  const [showCustomizer, setShowCustomizer] = useState(false);\n  const [selectedProduct, setSelectedProduct] = useState(null);\n\n  const { addToCart } = useCart();\n  const { user, isAuthenticated } = useAuth();\n  const location = useLocation();\n  \n  // Log de d√©bogage pour v√©rifier l'√©tat de connexion\n  useEffect(() => {\n    console.log('üîç √âtat de connexion dans Products:', { \n      user: !!user, \n      isAuthenticated, \n      userId: user?._id \n    });\n  }, [user, isAuthenticated]);\n\n  // G√©rer les param√®tres URL pour les filtres\n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const genreParam = searchParams.get('genre');\n    const categoryParam = searchParams.get('categorie');\n    \n    if (genreParam) {\n      setFilters(prev => ({\n        ...prev,\n        genre: genreParam,\n        category: '' // R√©initialiser la cat√©gorie si on filtre par genre\n      }));\n    } else if (categoryParam) {\n      setFilters(prev => ({\n        ...prev,\n        category: categoryParam,\n        genre: '' // R√©initialiser le genre si on filtre par cat√©gorie\n      }));\n    }\n  }, [location.search]);\n\n\n  useEffect(() => {\n    // Charger les produits en priorit√©\n    fetchProducts();\n    \n    // Charger les cat√©gories et marques seulement si pas encore charg√©es\n    if (categories.length === 0) {\n      fetchCategories();\n    }\n    if (brands.length === 0) {\n      fetchBrands();\n    }\n  }, [filters, sortBy, searchTerm, currentPage]);\n\n  const fetchProducts = async () => {\n    try {\n      setLoading(true);\n      const params = {\n        page: currentPage,\n        limit: 12,\n        tri: sortBy\n      };\n      \n      // Mapper les filtres vers les noms attendus par le backend\n      if (filters.category) params.categorie = filters.category;\n      if (filters.genre) params.genre = filters.genre;\n      if (filters.brand) params.marque = filters.brand;\n      if (filters.minPrice) params.prixMin = filters.minPrice;\n      if (filters.maxPrice) params.prixMax = filters.maxPrice;\n      if (filters.size) params.taille = filters.size;\n      if (filters.color) params.couleur = filters.color;\n      \n      if (searchTerm) params.recherche = searchTerm;\n\n      // Ajouter un timeout pour √©viter les attentes trop longues\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), 2000); // 2 secondes max\n\n      const response = await api.get('/products', { \n        params,\n        signal: controller.signal,\n        timeout: 2000\n      });\n      \n      clearTimeout(timeoutId);\n      const data = response.data;\n      \n      const produits = data.products || [];\n      debugObjects(produits, 'Products - fetchProducts');\n      \n      // Filtrer les produits pour ne garder que ceux qui sont disponibles (en stock)\n      const produitsDisponibles = produits.filter(product => {\n        // V√©rifier si le produit a des tailles avec du stock\n        if (product.tailles && Array.isArray(product.tailles)) {\n          return product.tailles.some(taille => taille.stock > 0);\n        }\n        // Si pas de tailles d√©finies, consid√©rer comme disponible\n        return true;\n      });\n      \n      console.log('Produits re√ßus:', produits.length);\n      console.log('Produits disponibles apr√®s filtrage:', produitsDisponibles.length);\n      \n      setProducts(produitsDisponibles);\n      setTotalPages(data.totalPages || 1);\n    } catch (error) {\n      if (error.name === 'AbortError') {\n        console.log('Timeout: Le serveur met trop de temps √† r√©pondre');\n        setTimeoutError(true);\n        setProducts([]);\n        setTotalPages(1);\n      } else {\n        console.log('Aucun produit trouv√© ou base de donn√©es vide');\n        setTimeoutError(false);\n        setProducts([]);\n        setTotalPages(1);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchCategories = async () => {\n    try {\n      // Utiliser des cat√©gories statiques pour simplifier\n      const staticCategories = [\n        { _id: '1', nom: 'Hoodies', code: 'hoodies' },\n        { _id: '2', nom: 'T-Shirts', code: 't-shirts' },\n        { _id: '3', nom: 'Sweats', code: 'sweats' },\n        { _id: '4', nom: 'Pantalons', code: 'pantalons' },\n        { _id: '5', nom: 'Accessoires', code: 'accessoires' }\n      ];\n      setCategories(staticCategories);\n    } catch (error) {\n      console.log('Erreur chargement cat√©gories');\n      setCategories([]);\n    }\n  };\n\n  const fetchBrands = async () => {\n    try {\n      // Utiliser des marques statiques pour simplifier\n      const staticBrands = [\n        { _id: '1', nom: 'Premium', code: 'premium' },\n        { _id: '2', nom: 'Basique', code: 'basique' },\n        { _id: '3', nom: 'Comfort', code: 'comfort' },\n        { _id: '4', nom: 'Style', code: 'style' },\n        { _id: '5', nom: 'Sport', code: 'sport' }\n      ];\n      setBrands(staticBrands);\n    } catch (error) {\n      console.log('Erreur chargement marques');\n      setBrands([]);\n    }\n  };\n\n  const handleFilterChange = (key, value) => {\n    setFilters(prev => ({ ...prev, [key]: value }));\n    setCurrentPage(1);\n  };\n\n  const handleSortChange = (value) => {\n    setSortBy(value);\n    setCurrentPage(1);\n  };\n\n  const handleSearch = (e) => {\n    e.preventDefault();\n    setCurrentPage(1);\n  };\n\n  const clearFilters = () => {\n    setFilters({\n      category: '',\n      brand: '',\n      minPrice: '',\n      maxPrice: '',\n      size: '',\n      color: ''\n    });\n    setSearchTerm('');\n    setCurrentPage(1);\n  };\n\n  const handleRetry = () => {\n    setTimeoutError(false);\n    setLoading(true);\n    fetchProducts();\n  };\n\n  const handleAddToCart = async (product, selectedSize, selectedColor) => {\n    console.log('handleAddToCart appel√© avec:', { \n      product: product?.nom, \n      productId: product?._id, \n      selectedSize, \n      selectedColor, \n      user: !!user \n    });\n\n    if (!user) {\n      console.log('Utilisateur non connect√©');\n      toast.error('Veuillez vous connecter pour ajouter au panier');\n      return;\n    }\n\n    // Utiliser des valeurs par d√©faut si aucune taille/couleur s√©lectionn√©e\n    const size = selectedSize || 'M';\n    const color = selectedColor || 'Noir';\n\n    console.log('Tentative d\\'ajout au panier...');\n    const result = await addToCart(product._id, 1, size, color);\n    console.log('R√©sultat de l\\'ajout au panier:', result);\n    if (!result.success) {\n      // Le toast d'erreur est d√©j√† affich√© dans CartContext\n      console.error('Erreur ajout au panier:', result.message);\n    }\n  };\n\n  const handleCustomize = (product) => {\n    setSelectedProduct(product);\n    setShowCustomizer(true);\n  };\n\n  const handleCloseCustomizer = () => {\n    setShowCustomizer(false);\n    setSelectedProduct(null);\n  };\n\n  const handleCustomAddToCart = async (customProduct, selectedSize, selectedColor) => {\n    if (!user) {\n      toast.error('Veuillez vous connecter pour ajouter au panier');\n      return;\n    }\n\n    // Pour les produits personnalis√©s, on ajoute les informations de personnalisation\n    const customData = {\n      productId: customProduct._id,\n      personnalisation: customProduct.personnalisation,\n      size: selectedSize || 'M',\n      color: selectedColor || customProduct.personnalisation?.couleur?.nom || 'Noir'\n    };\n\n    console.log('Ajout produit personnalis√© au panier:', customData);\n    \n    // Ici, vous pourriez adapter la logique d'ajout au panier pour les produits personnalis√©s\n    const result = await addToCart(customProduct._id, 1, customData.size, customData.color);\n    \n    if (result.success) {\n      toast.success('Produit personnalis√© ajout√© au panier !');\n      handleCloseCustomizer();\n    } else {\n      console.error('Erreur ajout produit personnalis√©:', result.message);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"loading-container\">\n        <div className=\"loading-spinner\"></div>\n        <p>Chargement des produits...</p>\n      </div>\n    );\n  }\n\n  return (\n    <DebugWrapper name=\"Products\">\n      <div className=\"products-page\">\n        <div className=\"products-header\">\n          <h1>Nos Produits</h1>\n          <p>D√©couvrez notre collection de v√™tements tendance</p>\n        </div>\n\n        <div className=\"products-container\">\n          {/* Filtres et recherche */}\n          <div className={`filters-sidebar ${showFilters ? 'show' : ''}`}>\n            <div className=\"filters-header\">\n              <h3>Filtres</h3>\n              <button \n                className=\"clear-filters\"\n                onClick={clearFilters}\n              >\n                Effacer\n              </button>\n            </div>\n\n            <form onSubmit={handleSearch} className=\"search-form\">\n              <div className=\"search-input\">\n                <FaSearch />\n                <input\n                  type=\"text\"\n                  placeholder=\"Rechercher un produit...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                />\n              </div>\n            </form>\n\n            {categories && categories.length > 0 && (\n              <div className=\"filter-section\">\n                <h4>Cat√©gorie</h4>\n                <select\n                  value={filters.category}\n                  onChange={(e) => handleFilterChange('category', e.target.value)}\n                >\n                  <option value=\"\">Toutes les cat√©gories</option>\n                  {categories.map(cat => {\n                    const key = typeof cat === 'object' ? (cat._id || cat.code || cat.nom || 'unknown') : cat;\n                    const value = typeof cat === 'object' ? (cat.nom || cat.code || cat._id || '') : cat;\n                    const display = typeof cat === 'object' ? (cat.nom || cat.code || cat._id || '') : cat;\n                    return (\n                      <option key={key} value={value}>\n                        {display}\n                      </option>\n                    );\n                  })}\n                </select>\n              </div>\n            )}\n\n            <div className=\"filter-section\">\n              <h4>Genre</h4>\n              <select\n                value={filters.genre}\n                onChange={(e) => handleFilterChange('genre', e.target.value)}\n              >\n                <option value=\"\">Tous les genres</option>\n                <option value=\"homme\">üë® Homme</option>\n                <option value=\"femme\">üë© Femme</option>\n                <option value=\"enfant\">üë∂ Enfant</option>\n                <option value=\"sport\">üèÉ Sport</option>\n              </select>\n            </div>\n\n            {brands && brands.length > 0 && (\n              <div className=\"filter-section\">\n                <h4>Marque</h4>\n                <select\n                  value={filters.brand}\n                  onChange={(e) => handleFilterChange('brand', e.target.value)}\n                >\n                  <option value=\"\">Toutes les marques</option>\n                  {brands.map(brand => {\n                    const key = typeof brand === 'object' ? (brand._id || brand.code || brand.nom || 'unknown') : brand;\n                    const value = typeof brand === 'object' ? (brand.nom || brand.code || brand._id || '') : brand;\n                    const display = typeof brand === 'object' ? (brand.nom || brand.code || brand._id || '') : brand;\n                    return (\n                      <option key={key} value={value}>\n                        {display}\n                      </option>\n                    );\n                  })}\n                </select>\n              </div>\n            )}\n\n            <div className=\"filter-section\">\n              <h4>Prix</h4>\n              <div className=\"price-inputs\">\n                <input\n                  type=\"number\"\n                  placeholder=\"Min\"\n                  value={filters.minPrice}\n                  onChange={(e) => handleFilterChange('minPrice', e.target.value)}\n                />\n                <span>-</span>\n                <input\n                  type=\"number\"\n                  placeholder=\"Max\"\n                  value={filters.maxPrice}\n                  onChange={(e) => handleFilterChange('maxPrice', e.target.value)}\n                />\n              </div>\n            </div>\n\n            <div className=\"filter-section\">\n              <h4>Taille</h4>\n              <select\n                value={filters.size}\n                onChange={(e) => handleFilterChange('size', e.target.value)}\n              >\n                <option value=\"\">Toutes les tailles</option>\n                <option value=\"XS\">XS</option>\n                <option value=\"S\">S</option>\n                <option value=\"M\">M</option>\n                <option value=\"L\">L</option>\n                <option value=\"XL\">XL</option>\n                <option value=\"XXL\">XXL</option>\n              </select>\n            </div>\n\n            <div className=\"filter-section\">\n              <h4>Couleur</h4>\n              <select\n                value={filters.color}\n                onChange={(e) => handleFilterChange('color', e.target.value)}\n              >\n                <option value=\"\">Toutes les couleurs</option>\n                <option value=\"noir\">Noir</option>\n                <option value=\"blanc\">Blanc</option>\n                <option value=\"rouge\">Rouge</option>\n                <option value=\"bleu\">Bleu</option>\n                <option value=\"vert\">Vert</option>\n                <option value=\"jaune\">Jaune</option>\n                <option value=\"rose\">Rose</option>\n                <option value=\"gris\">Gris</option>\n              </select>\n            </div>\n          </div>\n\n          {/* Produits */}\n          <div className=\"products-main\">\n            <div className=\"products-toolbar\">\n              <button\n                className=\"filters-toggle\"\n                onClick={() => setShowFilters(!showFilters)}\n              >\n                <FaFilter />\n                Filtres\n              </button>\n\n              <div className=\"sort-controls\">\n                <FaSort />\n                <select\n                  value={sortBy}\n                  onChange={(e) => handleSortChange(e.target.value)}\n                >\n                  <option value=\"name\">Nom A-Z</option>\n                  <option value=\"-name\">Nom Z-A</option>\n                  <option value=\"prix\">Prix croissant</option>\n                  <option value=\"-prix\">Prix d√©croissant</option>\n                  <option value=\"createdAt\">Plus r√©cents</option>\n                  <option value=\"-createdAt\">Plus anciens</option>\n                </select>\n              </div>\n\n              <div className=\"results-info\">\n                {products?.length || 0} produit(s) disponible(s)\n                <small style={{ display: 'block', color: '#666', fontSize: '0.9em' }}>\n                  Seuls les produits en stock sont affich√©s\n                </small>\n              </div>\n            </div>\n\n            {!products || products.length === 0 ? (\n              <div className=\"no-products\">\n                {timeoutError ? (\n                  <>\n                    <h3>‚è±Ô∏è D√©lai d'attente d√©pass√©</h3>\n                    <p>Le serveur met trop de temps √† r√©pondre. Voulez-vous r√©essayer ?</p>\n                    <button onClick={handleRetry} className=\"retry-button\">\n                      üîÑ R√©essayer\n                    </button>\n                  </>\n                ) : (\n                  <>\n                    <h3>Aucun produit disponible</h3>\n                    <p>\n                      {searchTerm || Object.values(filters).some(f => f) \n                        ? \"Aucun produit en stock ne correspond √† vos crit√®res. Essayez de modifier vos filtres ou votre recherche.\" \n                        : \"Aucun produit en stock pour le moment. La boutique est en cours de pr√©paration. Revenez bient√¥t !\"\n                      }\n                    </p>\n                  </>\n                )}\n              </div>\n            ) : (\n              <>\n                <div className=\"products-grid\">\n                  {products?.map(product => (\n                    <ProductCard\n                      key={product._id}\n                      product={product}\n                      onAddToCart={handleAddToCart}\n                      onCustomize={handleCustomize}\n                    />\n                  ))}\n                </div>\n\n                {/* Pagination */}\n                {totalPages > 1 && (\n                  <div className=\"pagination\">\n                    <button\n                      onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}\n                      disabled={currentPage === 1}\n                    >\n                      Pr√©c√©dent\n                    </button>\n                    \n                    {Array.from({ length: totalPages }, (_, i) => i + 1).map(page => (\n                      <button\n                        key={page}\n                        onClick={() => setCurrentPage(page)}\n                        className={currentPage === page ? 'active' : ''}\n                      >\n                        {page}\n                      </button>\n                    ))}\n                    \n                    <button\n                      onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}\n                      disabled={currentPage === totalPages}\n                    >\n                      Suivant\n                    </button>\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Customizer Modal */}\n      {showCustomizer && selectedProduct && (\n        <SimpleHoodieDesigner\n          onClose={handleCloseCustomizer}\n        />\n      )}\n    </DebugWrapper>\n  );\n};\n\nexport default Products;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}